# Generated by lzctl {{ .Version }} — safe to edit
#
# State Life Management:
#   • State is the single source of truth for your infrastructure
#   • Azure Storage uses blob lease locking to prevent concurrent writes
#   • Blob versioning preserves state history for auditable rollbacks
#   • Soft delete protects against accidental state deletion
#   • Run 'lzctl state health' to validate backend security posture
#   • Run 'lzctl state snapshot --all' before major changes
#
terraform {
  backend "azurerm" {
    resource_group_name  = "{{ .Config.Spec.StateBackend.ResourceGroup }}"
    storage_account_name = "{{ .Config.Spec.StateBackend.StorageAccount }}"
    container_name       = "{{ .Config.Spec.StateBackend.Container }}"
    key                  = "platform/shared/terraform.tfstate"
    subscription_id      = "{{ .Config.Spec.StateBackend.Subscription }}"
    # Locking: Azure blob lease (automatic — no extra config needed)
    # Encryption: Azure Storage encrypts at rest by default (AES-256)
    use_azuread_auth     = true
  }
}
